# Runes Capsule Webinar - Session 4

**Date:** December 14, 2025  
**Topics:** Runes Capsule Demo, sBTC Bridge Integration

---

## Runes Capsule Demo

### Live Deposit Walkthrough

The session opened with a live demo of depositing tokens into a Runes Capsule using MOM's tokens (MS tokens) — the dummy tokens used for the Stacks-side pilot.

**Deposit Flow:**

1. Select the asset to deposit
2. Sign a PSBT via Xverse wallet
3. Wallet recognizes the transaction (e.g., sending 69 MS tokens)
4. An `OP_RETURN` encodes:
   - The asset (Rune ID)
   - The amount
   - The receiving Runes Capsule address

**What Happens Next:**

1. Wait for the Bitcoin transaction to anchor
2. Verify the transaction on the Stacks side
3. The contract parses the `OP_RETURN` data
4. Merkle proof is deduced and fed to the smart contract
5. Wrapped tokens are minted on Stacks

### Vision

The goal is for Runes Capsule to become a **standard protocol** for Runes ↔ Stacks communication, enabling anyone to activate Square Runes on Stacks.

---

## sBTC Bridge Integration Workshop

_Presented by Eric from the Stacks Hacker House event_

### What is sBTC?

sBTC is a **1:1 Bitcoin-backed token** on Stacks. The sBTC bridge allows users to bridge their Bitcoin into Stacks L2 seamlessly.

### Why Integrate?

Integrating the sBTC bridge keeps users **within your application** throughout the bridging process — no context-switching to external bridge UIs.

### Technical Stack

- **Library:** `sbtc.js` (part of the Stacks.js monorepo)
- **Communication:** sBTC signers' address and protocol
- **Signers Role:** Manage, validate, and perform security checks for the bridging process

---

## Deposit Flow (4 Steps)

### Step 1: Build the sBTC Deposit Address

Creates a **Taproot address** with two scripts:

| Script         | Controlled By | Purpose                             |
| -------------- | ------------- | ----------------------------------- |
| Deposit Script | Signers       | Normal deposit flow                 |
| Reclaim Script | User          | Fallback if deposit isn't confirmed |

> **Safety feature:** The reclaim script has a timelock — user can reclaim their Bitcoin after X blocks if something goes wrong.

### Step 2: Sign & Broadcast

Invoke the user's wallet to sign and broadcast a Bitcoin transaction to the deposit address.

### Step 3: Notify Signers

Alert the sBTC signers that a deposit has been made so they can process it.

### Step 4: Confirm & Update UI

- Confirmation time: **~1-2 Bitcoin blocks**
- Update the user's sBTC balance in your app

---

## Withdrawal Flow (Simpler)

Withdrawals are less complex — just **one Clarity contract call**.

### Step 1: Validate Address

Validate the Bitcoin address specified by the user for receiving their BTC.

### Step 2: Contract Call

Call the `peg-out-request` function in the sBTC withdrawal contract.

```clarity
(contract-call? .sbtc-withdrawal peg-out-request ...)
```

### Step 3: Confirm Withdrawal

- Use the **Emily API** to check withdrawal status
- Confirmation time: **~6 Bitcoin blocks**

### How Withdrawal Works Internally

1. User's sBTC is transferred to the contract
2. sBTC is **burned**
3. An "sBTC locked" token is minted (for accounting)
4. Signers track tokens queued for withdrawal
5. Bitcoin is released to user's specified address

---

## Other Topics Discussed

### Twitter Voting Widget

Discussion of a voting widget on fak.fun that uses Twitter authentication — part of the launch activities for Runes Capsule project selection.

### Smart Wallets & Passkeys

Interest in building **smart wallets** using passkeys:

- Private key stored in device's secure enclave
- Enables smoother UX without seed phrase management
- Potential future integration for Capsule

---

## Key Takeaways

1. **Runes Capsule deposit flow** is live and working with PSBT signing
2. **sBTC integration** is straightforward with `sbtc.js` library
3. **Deposit:** ~1-2 block confirmations
4. **Withdrawal:** ~6 block confirmations
5. **Reclaim scripts** provide safety net for failed deposits
6. **Emily API** is the go-to for checking withdrawal status

---

## Resources

- [sBTC Documentation](https://docs.stacks.co/sbtc)
- [Stacks.js / sbtc.js](https://github.com/hirosystems/stacks.js)
- [Runes Capsule GitHub](https://github.com/uasu-finance/runes-capsule)
- [fak.fun Voting](https://fak.fun/capsule)
